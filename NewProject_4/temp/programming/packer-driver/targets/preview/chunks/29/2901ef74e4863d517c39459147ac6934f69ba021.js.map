{"version":3,"sources":["file:///Users/feiwang/tg_cocos/NewProject_4/assets/resources/scripts/discover/gamesScrollControl.ts"],"names":["_decorator","Component","Node","UITransform","ccclass","property","EventType","gamesScrollControl","type","Number","tooltip","EventHandler","childs","isTouching","hasTouchMove","isTestX","_touchId","currentIndex","_toMoveX","dx","moveAim","onLoad","i","content","children","length","setPosition","deltaX","getPosition","y","x","start","on","TOUCH_START","_onTouch","TOUCH_MOVE","TOUCH_END","_onTouchEnd","TOUCH_CANCEL","scrollTo","idx","anim","console","error","node","name","_checkChildX","emitEvents","selectEvents","target","SCROLL_START","index","scrollToLeft","scrollToRight","child","Y","Math","min","abs","scale","centerScale","minScale","event","touch","getStartLocation","evt","getLocation","_move","SCROLL_ING","lo","getComponent","convertToNodeSpaceAR","mx","ceil","event1","SCROLL_END","max","minidx","dt","update","deltaTime","stepx","scrollSpeed","lx","round","tox","cx"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventHandler, Node, UITransform } from 'cc';\nconst { ccclass, property } = _decorator;\n\nexport enum EventType {\n\tSCROLL_START,\n\tSCROLL_ING,\n\tSCROLL_END\n}\n\n@ccclass('gamesScrollControl')\nexport class gamesScrollControl extends Component {\n\n    @property(Node)\n\tcontent: Node = null;\n\t@property({\n\t\ttype: Number,\n\t\ttooltip: '单个控件之间的距离'\n\t})\n\tdeltaX: number = 100 //x间隔距离\n\t@property({\n\t\ttype: Number,\n\t\ttooltip: '中心点的缩放比例'\n\t})\n\tcenterScale: number = 1.0\n\t@property({\n\t\ttype: Number,\n\t\ttooltip: '边缘点的缩放比例'\n\t})\n\tminScale: number = 1.0\n\t@property({\n\t\ttype: Number,\n\t\ttooltip: '滚动时的速度'\n\t})\n\tscrollSpeed: number = 300;\n\t@property({\n\t\ttype: Component.EventHandler,\n\t\ttooltip: \"选择后的回调\"\n\t})\n    selectEvents: Array<EventHandler> = [];\n\n    private childs: Array<Node> = [];\n\tprivate isTouching: boolean = false;\n\tprivate hasTouchMove: boolean = false;\n\tprivate isTestX: boolean = false;\n\tprivate _touchId: any = null;\n\tprivate currentIndex: number = 0;\n\tprivate _toMoveX: number = 1; //移动方向\n\tprivate dx: number = 0;\n\tprivate moveAim: number = 0;\n\n    protected onLoad() {\n        this.childs = [];\n\t\tfor (var i = 0; i < this.content.children.length; i++) {\n\t\t\tthis.childs[i] = this.content.children[i];\n            this.childs[i].setPosition(this.deltaX * (i - 1), this.childs[i].getPosition().y)\n\t\t\tthis.childs[i].getPosition().x = this.deltaX * (i - 1);\n\t\t}\n\t\tthis.isTouching = false\n\t\tthis.hasTouchMove = false\n\t\tthis.isTestX = false;\n\t\tthis._touchId = null;\n\t\t//this.currentIndex = 0;\n\t\t//this.scrollTo(0, false);\n    }\n\n    start() {\n        this.content.on(Node.EventType.TOUCH_START, this._onTouch, this);\n\t\tthis.content.on(Node.EventType.TOUCH_MOVE, this._onTouch, this);\n\t\tthis.content.on(Node.EventType.TOUCH_END, this._onTouchEnd, this);\n\t\tthis.content.on(Node.EventType.TOUCH_CANCEL, this._onTouchEnd, this);\n    }\n\n    \t/** 滚动到指定节点 \n\t * @param anim 是否带移动动画\n\t*/\n\tscrollTo(idx: number, anim: boolean = true) {\n\t\tif (idx < 0 && idx >= this.childs.length) {\n\t\t\treturn console.error(this.node.name + '->移动超出边界面')\n\t\t}\n\t\tthis.currentIndex = idx;\n\t\tthis.moveAim = idx;\n\t\tif (!anim) {\n\t\t\tfor (var i = 0; i < this.childs.length; i++) {\n\t\t\t\tthis._checkChildX(this.childs[i], (i - idx) * this.deltaX)\n\t\t\t}\n\t\t} else {\n\t\t\tthis.isTestX = true\n\t\t\tComponent.EventHandler.emitEvents(this.selectEvents, {\n\t\t\t\ttarget: this,\n\t\t\t\ttype: EventType.SCROLL_START,\n\t\t\t\tindex: this.currentIndex\n\t\t\t});\n\t\t}\n\t}\n\n    /** 向左滚一个点 */\n\tscrollToLeft() {\n\t\tthis._toMoveX = 1\n\t\tthis.scrollTo((this.currentIndex - 1 + this.childs.length) % this.childs.length)\n\t}\n\n\t/** 向左滚一个点 */\n\tscrollToRight() {\n\t\tthis._toMoveX = -1\n\t\tthis.scrollTo((this.currentIndex + 1 + this.childs.length) % this.childs.length)\n\t}\n\n\t_checkChildX(child, x) {\n\t\tif (x > this.childs.length / 2 * this.deltaX) {\n\t\t\tx -= this.childs.length * this.deltaX\n\t\t} else if (x < -this.childs.length / 2 * this.deltaX) {\n\t\t\tx += this.childs.length * this.deltaX\n\t\t}\n\t\tchild.setPosition(x, child.getPosition().Y)\n\t\tlet dx = Math.min(Math.abs(x), this.deltaX)\n\t\tchild.scale = (1 - dx / this.deltaX) * (this.centerScale - this.minScale) + this.minScale\n\t}\n\n\t_onTouch(event) {\n\t\tif (this._touchId != null && event.touch != this._touchId) {\n\t\t\treturn;\n\t\t}\n\t\tif (event.type == Node.EventType.TOUCH_START) {\n\t\t\tthis.isTouching = true;\n\t\t\tthis.hasTouchMove = false\n\t\t\tthis.isTestX = false;\n\t\t\tthis._touchId = event.touch;\n\t\t\tthis.dx = event.getStartLocation().x;\n\t\t\tlet evt = {\n\t\t\t\ttarget: this,\n\t\t\t\ttype: EventType.SCROLL_START,\n\t\t\t\tindex: this.currentIndex\n\t\t\t}\n\t\t\tComponent.EventHandler.emitEvents(this.selectEvents, evt);\n\t\t\treturn;\n\t\t}\n\t\tthis.hasTouchMove = true;\n\t\tvar dx = event.getLocation().x - this.dx\n\t\tthis._move(dx);\n\t\tthis.dx = event.getLocation().x\n\t\tvar evt = {\n\t\t\ttarget: this,\n\t\t\ttype: EventType.SCROLL_ING,\n\t\t\tdx: this.dx\n\t\t}\n\t\tComponent.EventHandler.emitEvents(this.selectEvents, evt);\n\t}\n\t_onTouchEnd(event) {\n\t\tif (this._touchId != null && event.touch != this._touchId) {\n\t\t\treturn;\n\t\t}\n\t\tthis.isTouching = false;\n\t\tif (event.type == Node.EventType.TOUCH_END || event.type == Node.EventType.TOUCH_CANCEL) {\n\t\t\tthis._touchId = null;\n\t\t}\n\t\tlet lo = this.node.getComponent(UITransform).convertToNodeSpaceAR(event.getLocation())\n\t\tif (!this.hasTouchMove) {\n\n\t\t\tlet mx = Math.ceil((lo.x - this.deltaX / 2) / this.deltaX)\n\t\t\tif (mx === 0) {\n\t\t\t\tvar event1 = {\n\t\t\t\t\ttarget: this,\n\t\t\t\t\ttype: EventType.SCROLL_END,\n\t\t\t\t\tindex: this.currentIndex\n\t\t\t\t}\n\t\t\t\t//Component.EventHandler.emitEvents(this.selectEvents, event1);\n\t\t\t} else {\n\t\t\t\tthis.moveAim = (this.currentIndex + mx + this.childs.length) % this.childs.length\n\t\t\t\tthis._toMoveX = mx > 0 ? -1 : 1\n\t\t\t\tthis.isTestX = true;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tlet max = this.deltaX;\n\t\tlet minidx = 0\n\t\tfor (let i = 0; i < this.childs.length; i++) {\n\t\t\tif (Math.abs(this.childs[i].getPosition().x) <= max) {\n\t\t\t\tmax = Math.abs(this.childs[i].getPosition().x)\n\t\t\t\tminidx = i;\n\t\t\t}\n\t\t}\n\t\tthis.moveAim = minidx\n\t\tthis._toMoveX = this.childs[minidx].getPosition().x >= 0 ? -1 : 1\n\t\tthis.isTestX = true;\n\t}\n\t_move(dt) {\n\t\tfor (var i = 0; i < this.childs.length; i++) {\n\t\t\tthis._checkChildX(this.childs[i], this.childs[i].getPosition().x + dt)\n\t\t}\n\t}\n\n    update(deltaTime: number) {\n        if (this.isTouching || !this.isTestX) {\n\t\t\treturn;\n\t\t}\n\t\tvar stepx = this._toMoveX * deltaTime * this.scrollSpeed\n\t\tlet lx = this.childs[this.moveAim].getPosition().x\n\t\tfor (var i = 0; i < this.childs.length; i++) {\n\t\t\tthis._checkChildX(this.childs[i], this.childs[i].getPosition().x + stepx)\n\t\t}\n\n\t\tvar x = this.childs[0].getPosition().x;\n\t\tvar idx = Math.round(x / this.deltaX);\n\t\tvar tox = this.deltaX * idx;\n\t\tlet cx = this.childs[this.moveAim].getPosition().x\n\t\tif (lx * cx < 0 && Math.abs(cx) < this.deltaX) {\n\t\t\tthis.isTestX = false;\n\t\t\tfor (let i = 0; i < this.childs.length; i++) {\n\t\t\t\tif (Math.abs(this.childs[i].getPosition().x) <= Math.abs(stepx)) {\n\t\t\t\t\tthis.currentIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var i = 0; i < this.childs.length; i++) {\n\t\t\t\tthis._checkChildX(this.childs[i], this.childs[i].getPosition().x + tox - x)\n\t\t\t}\n\t\t\tvar event = {\n\t\t\t\ttarget: this,\n\t\t\t\ttype: EventType.SCROLL_END,\n\t\t\t\tindex: this.currentIndex\n\t\t\t}\n\t\t\tComponent.EventHandler.emitEvents(this.selectEvents, event);\n\t\t}\n    }\n}\n\n"]}