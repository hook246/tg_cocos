{"version":3,"sources":["file:///Users/feiwang/NewProject_4/assets/resources/scripts/draw/drawModel.ts"],"names":["_decorator","basePageModel","GlobalConfig","ccclass","property","walletUrls","bindWallet","unbindWallet","queryBindWallet","drawModel","start","window","bindUxuyWallet","update","deltaTime","walletAddress","walletChain","uxuyethereum","_account","address","chainName","uxuyWalletConnect","console","log","walletInfo","axios","post","headers","_instance","token","data","code","unBindWallet","getWalletInfo"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;;AACAC,MAAAA,a,iBAAAA,a;;AAEAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U;;4BAmBjBK,U,GAAa;AACxBC,QAAAA,UAAU,EAAE,8DADY;AAExBC,QAAAA,YAAY,EACV,gEAHsB;AAIxBC,QAAAA,eAAe,EACb;AALsB,O;;2BAqCbC,S,WADZN,OAAO,CAAC,WAAD,C,gBAAR,MACaM,SADb;AAAA;AAAA,0CAC6C;AAC3CC,QAAAA,KAAK,GAAG;AACNC,UAAAA,MAAM,CAACC,cAAP,GAAwB,KAAKA,cAA7B;AACD;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAAE;;AAER,cAAdF,cAAc,GAAG;AAAA;;AACrB,cAAIG,aAAJ;AACA,cAAIC,WAAJ;;AACA,cAAGL,MAAM,CAACM,YAAP,CAAoBC,QAApB,CAA6BC,OAAhC,EAAwC;AACtCJ,YAAAA,aAAa,GAAGJ,MAAM,CAACM,YAAP,CAAoBC,QAApB,CAA6BC,OAA7C;AACAH,YAAAA,WAAW,GAAGL,MAAM,CAACM,YAAP,CAAoBC,QAApB,CAA6BE,SAA3C;AACD,WAHD,MAGK;AACH,kBAAMT,MAAM,CAACU,iBAAP,EAAN;AACAN,YAAAA,aAAa,GAAGJ,MAAM,CAACM,YAAP,CAAoBC,QAApB,CAA6BC,OAA7C;AACAH,YAAAA,WAAW,GAAGL,MAAM,CAACM,YAAP,CAAoBC,QAApB,CAA6BE,SAA3C;AACD;;AACDE,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBR,aAAvB,EAAsCC,WAAtC;AACA,gBAAMQ,UAAU,GAAG,MAAMb,MAAM,CAACc,KAAP,CAAaC,IAAb,CACvBrB,UAAU,CAACC,UADY,EACD;AACpBS,YAAAA,aAAa,EAAEA,aADK;AAEpBC,YAAAA,WAAW,EAAEA;AAFO,WADC,EAIrB;AACAW,YAAAA,OAAO,EAAE;AACL,4BAAc,mCADT;AAEL,8BAAgB,kBAFX;AAGL,+BAAiB;AAAA;AAAA,gDAAaC,SAAb,CAAuBC;AAHnC;AADT,WAJqB,CAAzB;AAYA,iBAAOL,UAAP,wCAAOA,UAAU,CAAEM,IAAnB,qBAAO,iBAAkBC,IAAzB;AACD;;AAIiB,cAAZC,YAAY,GAAG;AAAA;;AACnB,gBAAMR,UAAU,GAAG,MAAMb,MAAM,CAACc,KAAP,CAAaC,IAAb,CACvBrB,UAAU,CAACE,YADY,EAExB,EAFwB,EAErB;AACAoB,YAAAA,OAAO,EAAE;AACL,4BAAc,mCADT;AAEL,8BAAgB,kBAFX;AAGL,+BAAiB;AAAA;AAAA,gDAAaC,SAAb,CAAuBC;AAHnC;AADT,WAFqB,CAAzB;AASA,iBAAOL,UAAP,yCAAOA,UAAU,CAAEM,IAAnB,qBAAO,kBAAkBC,IAAzB;AACD;;AAEkB,cAAbE,aAAa,GAAG;AAAA;;AACpB,gBAAMT,UAAU,GAAG,MAAMb,MAAM,CAACc,KAAP,CAAaC,IAAb,CACvBrB,UAAU,CAACG,eADY,CAAzB;AAGA,iBAAOgB,UAAP,yCAAOA,UAAU,CAAEM,IAAnB,qBAAO,kBAAkBA,IAAzB;AACD;;AAtD0C,O","sourcesContent":["import { _decorator, Component, Node } from \"cc\";\nimport { basePageModel } from \"../common/basePageModel\";\nimport { AxiosResponse } from \"../login/loginModel\";\nimport { GlobalConfig } from \"../home/GlobalConfig\";\nconst { ccclass, property } = _decorator;\n\ndeclare global {\n  interface Window {\n    axios: {\n      post<T = any, R = AxiosResponse<T>, D = any>(\n        url: string,\n        data?: D,\n        config?: any\n      ): Promise<R>;\n    };\n    startCanvas: any;\n    uxuyethereum: any;\n    uxuyWalletConnect: any;\n\n    bindUxuyWallet\n  }\n}\n\nexport const walletUrls = {\n  bindWallet: \"https://api.infinitytest.cc/api/v1/user/info/edit/bindWallet\",\n  unbindWallet:\n    \"https://api.infinitytest.cc/api/v1/user/info/edit/unbindWallet\",\n  queryBindWallet:\n    \"https://api.infinitytest.cc/api/v1/user/info/queryBindWallet\",\n};\n\nexport interface BindWalletData {\n  walletAddress: string;\n  walletChain: string;\n}\n\nexport interface BindWalletResponse {\n  code: string;\n  message: string;\n}\n\nexport interface UnbindWalletData {}\n\nexport interface UnbindWalletResponse {\n  code: string;\n  message: string;\n}\n\nexport interface QueryBindWalletData {}\n\nexport interface QueryBindWalletResponse {\n  code: string;\n  data: {\n    walletAddress: string;\n    walletChain: string;\n  };\n  message: string;\n}\n\n@ccclass(\"drawModel\")\nexport class drawModel extends basePageModel {\n  start() {\n    window.bindUxuyWallet = this.bindUxuyWallet\n  }\n\n  update(deltaTime: number) {}\n\n  async bindUxuyWallet() {\n    let walletAddress\n    let walletChain\n    if(window.uxuyethereum._account.address){\n      walletAddress = window.uxuyethereum._account.address\n      walletChain = window.uxuyethereum._account.chainName\n    }else{\n      await window.uxuyWalletConnect()\n      walletAddress = window.uxuyethereum._account.address\n      walletChain = window.uxuyethereum._account.chainName\n    }\n    console.log('========',walletAddress, walletChain)\n    const walletInfo = await window.axios.post<BindWalletResponse>(\n      walletUrls.bindWallet,{\n        walletAddress: walletAddress,\n        walletChain: walletChain,\n      },{\n        headers: { \n            'User-Agent': 'Apifox/1.0.0 (https://apifox.com)', \n            'Content-Type': 'application/json',\n            'authorization': GlobalConfig._instance.token\n          }\n      }\n    );\n    return walletInfo?.data?.code;\n  }\n\n\n\n  async unBindWallet() {\n    const walletInfo = await window.axios.post<UnbindWalletResponse>(\n      walletUrls.unbindWallet\n    ,{},{\n        headers: { \n            'User-Agent': 'Apifox/1.0.0 (https://apifox.com)', \n            'Content-Type': 'application/json',\n            'authorization': GlobalConfig._instance.token\n          }\n    });\n    return walletInfo?.data?.code;\n  }\n\n  async getWalletInfo() {\n    const walletInfo = await window.axios.post<QueryBindWalletResponse>(\n      walletUrls.queryBindWallet\n    );\n    return walletInfo?.data?.data;\n  }\n}\n"]}