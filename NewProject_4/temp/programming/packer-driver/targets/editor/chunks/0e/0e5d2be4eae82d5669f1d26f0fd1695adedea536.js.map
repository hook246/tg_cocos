{"version":3,"sources":["file:///Users/feiwang/tg_cocos/NewProject_4/assets/resources/scripts/home/homeView.ts"],"names":["_decorator","Component","Label","Node","tween","UIOpacity","inviteModel","profileModel","earnView","WebUtils","PromiseUtils","ccclass","property","homeView","pageArray","btns","currentPageIndex","prePageIndex","start","window","Telegram","WebApp","setHeaderColor","discoverPage","invitePage","earnPage","drawPage","discoverPageBtn","invitePageBtn","earnPageBtn","drawPageBtn","shiftCurrentPage","btn","data","Number","setPosition","getComponent","opacity","currentPage","find","node","index","getPosition","x","to","wait","inviteBg","active","console","log","forEach","getChildByName","currentTarget","getTaskList","freshDailyTask","setProfile","url","getResouceImg","icon","showProfile","profile","initData","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Animation, AnimationClip, Component, EventTouch, Label, Node, tween, UIOpacity } from 'cc';\nimport { inviteView } from '../invite/inviteView';\nimport { inviteModel } from '../invite/inviteModel';\nimport { profileModel } from '../profile/profileModel';\nimport { earnView } from '../earn/earnView';\nimport WebUtils from '../common/WebUtils';\nimport { PromiseUtils } from '../common/PromiseUtils';\nconst { ccclass, property } = _decorator;\n\n@ccclass('homeView')\nexport class homeView extends Component {\n\n    @property(Node)\n    discoverPage: Node = null\n    @property(Node)\n    invitePage: Node = null\n    @property(Node)\n    earnPage: Node = null\n    @property(Node)\n    drawPage: Node = null\n\n    @property(Node)\n    discoverPageBtn: Node = null\n    @property(Node)\n    invitePageBtn: Node = null\n    @property(Node)\n    earnPageBtn: Node = null\n    @property(Node)\n    drawPageBtn: Node = null\n    @property(Node)\n    profile: Node = null\n\n    @property(Label)\n    game_point: Label = null\n\n    @property(Node)\n    inviteBg: Node = null\n\n    @property(Node)\n    icon: Node = null\n\n    pageArray: Node[] = [\n\n    ]\n\n    btns: Node[] = [\n\n    ]\n\n    currentPageIndex = 0\n    prePageIndex = 0\n    \n    start() {\n        window?.Telegram?.WebApp.setHeaderColor('#000000')\n        this.pageArray = [\n            this.discoverPage,\n            this.invitePage,\n            this.earnPage,\n            this.drawPage\n        ]\n\n        this.btns = [\n            this.discoverPageBtn,\n            this.invitePageBtn,\n            this.earnPageBtn,\n            this.drawPageBtn\n        ]\n    }\n\n    async shiftCurrentPage(btn: EventTouch, data: string){\n\n\n        (this.pageArray[Number(data)] as Node).setPosition(0,0);\n        (this.pageArray[Number(data)] as Node).getComponent(UIOpacity).opacity = 255\n        const currentPage = this.pageArray.find((node, index)=>{\n            return (this.pageArray[index] as Node).getPosition().x === 0\n        })\n\n        currentPage\n\n        tween(currentPage.getComponent(UIOpacity))?.to(0.5, { opacity: 0 }).start();\n        await PromiseUtils.wait(0.5)\n        currentPage.setPosition(-5000, 0)\n\n\n        // this.pageArray.forEach((page: Node, index)=>{\n        //     (this.pageArray[Number(data)] as Node).setPosition(0,0);\n        //     (this.pageArray[Number(data)] as Node).getComponent(UIOpacity).opacity = 255\n        //     if((this.pageArray[index] as Node).getPosition().x === 0){\n        //         if(Number(data) === index){\n        //             return\n        //         }\n        //         tween(this.pageArray[index].getComponent(UIOpacity))?.to(0.5, { opacity: 0 }).start();\n        //         this.scheduleOnce(()=>{\n        //             (this.pageArray[index] as Node).setPosition(-5000, 0);\n        //             (this.pageArray[index] as Node).getComponent(UIOpacity).opacity = 255\n        //         }, 0.7);\n        //     }\n\n\n\n\n        //     // if(Number(data) === index){\n        //     //     this.currentPageIndex = index;\n        //     //     (this.pageArray[index] as Node).setPosition(0,0);\n        //     //     (this.pageArray[index] as Node).getComponent(UIOpacity).opacity = 255\n        //     // }else{\n        //     //     //(this.pageArray[this.currentPageIndex] as Node).setPosition(-5000, 0);\n        //     //     tween(this.pageArray[index].getComponent(UIOpacity))?.to(0.5, { opacity: 0 }).start();\n        //     //     this.scheduleOnce(()=>{\n        //     //         (this.pageArray[index] as Node).setPosition(-5000, 0);\n        //     //     }, 0.5);\n        //     // }\n        // });\n\n        //(this.pageArray[this.prePageIndex] as Node)?.getComponent(Animation)?.play();\n        \n        if(Number(data) === 1){\n            this.inviteBg.active = true\n        }else{\n            this.inviteBg.active = false\n        }\n        console.log('======', btn)\n        this.btns.forEach((node)=>{\n            node.getChildByName('selectBg').active = false\n            node.getChildByName('selected').active = false\n        })\n        btn.currentTarget.getChildByName('selected').active = true\n        if(Number(data) === 2){\n            await this.invitePage.getComponent(inviteModel).getTaskList()\n            this.earnPage.getComponent(earnView).freshDailyTask()\n        }\n    }\n\n    setProfile(url: string){\n        WebUtils.getResouceImg(url, this.icon)\n    }\n\n    async showProfile(){\n        await this.invitePage.getComponent(inviteModel).getTaskList()\n        this.profile.getComponent(profileModel).initData()\n        this.profile.setPosition(0, 0)\n    }\n\n    update(deltaTime: number) {\n        \n    }\n}\n\n"]}