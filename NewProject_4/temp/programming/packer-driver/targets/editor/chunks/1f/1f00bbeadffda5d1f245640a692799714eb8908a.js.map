{"version":3,"sources":["file:///Users/feiwang/tg_cocos/NewProject_4/assets/resources/scripts/draw/drawView.ts"],"names":["_decorator","Label","Node","RichText","tween","UIOpacity","basePageView","GlobalData","ccclass","property","openRewardPos","drawView_arrow","drawView","drawLuckyInfo","drawLuckyClose","cost_tickets","start","localStorage","getItem","arrow","active","arrow_s","setJoinBtnUseAble","use","joinBtn","update","deltaTime","controlUnbindBtnVisible","visible","unBindWalletInfo","controlBindBtnVisible","bindWalletInfo","controlConnectWalletBtnsVisible","walletConnectBtns","showConnectWalletBtns","home","getChildByName","setTicketsCost","cost","tickets_cost","string","setJoinTips","lessTickets","join_tips","node","setWalletInfo","address","wallet_address","substring","length","showDrawLuckRewardInfo","rewardInfo","join","draw_lucky_result","getComponent","to","opacity","call","win","good_result","bad_result","reward_info","usdt","closeDrawLuckRewardInfo","setDrawLuckInfo","join_count","count","showOpenRewardInfo","setCurrentTicketsUsdtCount","info","tickets","data","tiket","closeBtnConnectWallets","markArrow","scroll","setItem","getScrollOffset","y","openDrawId","confirm"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node, RichText, ScrollView, Sprite, tween, UIOpacity, Vec3 } from \"cc\";\nimport { basePageView } from \"../common/basePageView\";\nimport GlobalData from \"../home/GloabalClass\";\nimport { ticketsUsdt } from \"./drawModel\";\nconst { ccclass, property } = _decorator;\n\nconst openRewardPos = 1000\nconst drawView_arrow = 'drawView_arrow'\n\nexport interface QueryDrawRespDTOData{\n  data:{\n    confirm: boolean;\n    example: false;\n    //开奖信息是否确认：false:未确认,true:已确认\n  \n    count: number;\n    //当前参加抽奖人数\n  \n    drawId: number;\n    //当前奖池ID\n  \n    drawTime: number;\n    //当前抽奖剩余开奖时间，时间戳\n  \n    join: boolean;\n    openDrawId: number;\n    //已开奖的奖池ID\n  \n    usdt: number;\n    //中奖奖品\n  \n    win: boolean;\n  }\n}\n\nexport interface QueryDrawRespDTO {\n  confirm: boolean;\n  example: false;\n  //开奖信息是否确认：false:未确认,true:已确认\n\n  count: number;\n  //当前参加抽奖人数\n\n  drawId: number;\n  //当前奖池ID\n\n  drawTime: number;\n  //当前抽奖剩余开奖时间，时间戳\n\n  join: boolean;\n  openDrawId: number;\n  //已开奖的奖池ID\n\n  usdt: number;\n  //中奖奖品\n\n  win: boolean;\n}\n\n@ccclass(\"drawView\")\nexport class drawView extends basePageView {\n  @property(Node)\n  walletConnectBtns: Node;\n\n  @property(Node)\n  unBindWalletInfo: Node;\n\n  @property(Node)\n  bindWalletInfo: Node;\n\n  @property(Label)\n  address: Label;\n\n  @property(Node)\n  home: Node;\n\n  @property(Node)\n  joinBtn: Node;\n\n  @property(Node)\n  arrow: Node;\n\n  @property(Node)\n  arrow_s: Node;\n\n  @property(Label)\n  tickets_cost: Label;\n\n  //门票和usdt数量设置\n  @property(Label)\n  tickets: Label;\n\n  @property(Label)\n  usdt: Label;\n\n  //开奖信息\n  @property(Label)\n  join_count: Label;\n\n  @property(Label)\n  timer: Label;\n\n  @property(Node)\n  draw_lucky_result: Node;\n\n  @property(Node)\n  good_result: Node;\n\n  @property(Node)\n  bad_result: Node;\n\n  @property(RichText)\n  join_tips: RichText;\n\n  @property(RichText)\n  reward_info: RichText;\n\n  drawLuckyInfo: QueryDrawRespDTO;\n  drawLuckyClose: boolean;\n  cost_tickets: any;\n\n  async start() {\n    if(localStorage.getItem(drawView_arrow)){\n      this.arrow.active = false\n      this.arrow_s.active = true\n    }\n  }\n\n  setJoinBtnUseAble(use: boolean){\n    use ? this.joinBtn.active = true : this.joinBtn.active = false\n  }\n\n  update(deltaTime: number) {\n\n  }\n\n  controlUnbindBtnVisible(visible: boolean) {\n    this.unBindWalletInfo.active = visible;\n  }\n\n  controlBindBtnVisible(visible: boolean) {\n    this.bindWalletInfo.active = visible;\n  }\n\n  controlConnectWalletBtnsVisible(visible: boolean) {\n    this.walletConnectBtns.active = visible;\n  }\n\n  showConnectWalletBtns() {\n    this.controlConnectWalletBtnsVisible(true);\n    this.home.getChildByName(\"tap_btns\").active = false;\n  }\n\n  setTicketsCost(cost: number){\n    this.tickets_cost.string = `${cost}`\n  }\n\n  setJoinTips(lessTickets){\n    if(lessTickets < 0){\n      this.join_tips.string = `<color=#00ff00>More entries boost your winning chances</color>\n<color=#0fffff>Collect ${lessTickets} more to enter the draw</color>`\n      this.setJoinBtnUseAble(false)\n    }else{\n      this.join_tips.node.active = false\n      this.setJoinBtnUseAble(true)\n    }\n  }\n\n  setWalletInfo(address: string) {\n    GlobalData.wallet_address = address;\n    this.controlBindBtnVisible(false);\n    this.controlUnbindBtnVisible(true);\n    this.address.string = `${address.substring(0, 6)}...${address.substring(\n      address.length - 6\n    )}`;\n  }\n\n  //弹窗展示当前获奖的信息\n  showDrawLuckRewardInfo(rewardInfo :QueryDrawRespDTO) {\n    if(rewardInfo.join){\n      this.draw_lucky_result.active = true\n      tween(this.draw_lucky_result.getComponent(UIOpacity)).to(0.5, { opacity: 255 }).call(()=>{\n  \n      }).start();\n\n      if(rewardInfo.win){\n        this.good_result.active = true\n        this.bad_result.active = false\n        this.reward_info.string = `${rewardInfo.usdt}usdt`\n      }else{ \n        this.good_result.active = false\n        this.bad_result.active = true\n      }\n\n    }else{\n\n    }\n\n  }\n\n  //关闭领奖弹窗\n  closeDrawLuckRewardInfo(){\n    this.draw_lucky_result.active = false\n    this.good_result.active = false\n    this.bad_result.active =false\n    this.draw_lucky_result.getComponent(UIOpacity).opacity = 0\n  }\n\n  //设置当前开奖情况的信息\n  setDrawLuckInfo(rewardInfo :QueryDrawRespDTO) {\n    this.drawLuckyInfo = rewardInfo\n    this.join_count.string = `${rewardInfo.count}`\n  }\n\n  //展示当前的开奖信息\n  showOpenRewardInfo(){\n\n  }\n\n  //设置当前的门票和usdt的信息\n  setCurrentTicketsUsdtCount(info: ticketsUsdt){\n    this.tickets.string = `${info.data.tiket}`\n    this.usdt.string = `${info.data.usdt}`\n  }\n\n  closeBtnConnectWallets() {\n    this.controlConnectWalletBtnsVisible(false);\n    this.home.getChildByName(\"tap_btns\").active = true;\n  }\n\n  markArrow(scroll: ScrollView, data){\n    localStorage.setItem(drawView_arrow, 'drawView_arrow')\n    this.arrow.active = false\n    this.arrow_s.active = true\n\n    if(scroll.getScrollOffset().y >= openRewardPos){\n      if(this.drawLuckyInfo.openDrawId && !this.drawLuckyInfo.confirm){\n        this.showDrawLuckRewardInfo(this.drawLuckyInfo)\n      }\n    }\n    \n  }\n}\n"]}