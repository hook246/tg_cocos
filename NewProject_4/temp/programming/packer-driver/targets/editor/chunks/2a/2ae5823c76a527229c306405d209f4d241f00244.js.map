{"version":3,"sources":["file:///Users/feiwang/NewProject_4/assets/resources/scripts/MainCtl.ts"],"names":["_decorator","Component","Node","Label","macro","EventDispatcher","GameData","LogicCtl","ccclass","property","MainCtl","type","start","home_page","setPosition","get_instance","target","on","UPDATE_SCORE_LABEL","update_score_label","START_GAME","start_game","schedule","auto_play","REPEAT_FOREVER","update","deltaTime","score_label","string","get_total_score","unschedule","reset_data","active","logic_ctl","run_game","get_game_state","auto_jump"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,K,OAAAA,K;;AACpCC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;AAC9B;AACA;AACA;AACA;AACA;;yBAEaU,O,WADZF,OAAO,CAAC,SAAD,C,UAIHC,QAAQ,CAAC;AAACE,QAAAA,IAAI,EAACT;AAAN,OAAD,C,UAGRO,QAAQ,CAAC;AAACE,QAAAA,IAAI;AAAA;AAAA;AAAL,OAAD,C,UAGRF,QAAQ,CAAC;AAACE,QAAAA,IAAI,EAACR;AAAN,OAAD,C,2BAVb,MACaO,OADb,SAC6BT,SAD7B,CACuC;AAAA;AAAA;;AAEnC;AAFmC;;AAKnC;AALmC;;AAQnC;AARmC;AAAA;;AAanCW,QAAAA,KAAK,GAAG;AAAA;;AACJ;AACA,kCAAKC,SAAL,qCAAgBC,WAAhB,CAA4B,CAA5B,EAA8B,CAA9B,EAFI,CAGJ;;AACA;AAAA;AAAA,kDAAgBC,YAAhB,GAA+BC,MAA/B,CAAsCC,EAAtC,CAAyC;AAAA;AAAA,kDAAgBC,kBAAzD,EAA4E,KAAKC,kBAAjF,EAAoG,IAApG,EAJI,CAKJ;;AACA;AAAA;AAAA,kDAAgBJ,YAAhB,GAA+BC,MAA/B,CAAsCC,EAAtC,CAAyC;AAAA;AAAA,kDAAgBG,UAAzD,EAAoE,KAAKC,UAAzE,EAAoF,IAApF,EANI,CAOJ;;AACA,eAAKC,QAAL,CAAc,KAAKC,SAAnB,EAA6B,CAA7B,EAA+BnB,KAAK,CAACoB,cAArC,EAAoD,CAApD;AACH;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CACzB;AAED;AACJ;AACA;;;AACIP,QAAAA,kBAAkB,GAAE;AAChB,eAAKQ,WAAL,CAAiBC,MAAjB,GAA0B;AAAA;AAAA,oCAASC,eAAT,KAA2B,EAArD;AACH;AAED;AACJ;AACA;;;AACIR,QAAAA,UAAU,GAAO;AAAA;;AACb,eAAKS,UAAL,CAAgB,KAAKP,SAArB,EADa,CAEb;;AACA,eAAKI,WAAL,CAAiBC,MAAjB,GAA0B,KAAG,CAA7B,CAHa,CAIb;;AACA;AAAA;AAAA,oCAASG,UAAT,GALa,CAMb;;AACA,eAAKlB,SAAL,CAAeC,WAAf,CAA2B,CAAC,IAA5B,EAAiC,CAAjC;AACA,eAAKD,SAAL,CAAemB,MAAf,GAAwB,KAAxB,CARa,CASb;;AACA,kCAAKC,SAAL,qCAAgBC,QAAhB,CAAyB,CAAzB;AACH;AACD;AACJ;AACA;;;AACIX,QAAAA,SAAS,GAAE;AACP;AACA,cAAG;AAAA;AAAA,oCAASY,cAAT,MAA6B,CAAC,CAAjC,EAAmC;AAC/B;AACA,iBAAKF,SAAL,CAAeG,SAAf;AACH;AACJ;;AA1DkC,O;;;;;iBAIlB,I;;;;;;;iBAGI,I;;;;;;;iBAGD,I","sourcesContent":["import { _decorator, Component, Node, Label, macro } from 'cc';\nimport { EventDispatcher } from './EventDispatcher';\nimport { GameData } from './GameData';\nimport { LogicCtl } from './LogicCtl';\nconst { ccclass, property } = _decorator;\n/**\n * 主脚本,挂载canvas上\n * @author 一朵毛山\n * Construct \n */\n@ccclass('MainCtl')\nexport class MainCtl extends Component {\n\n    //home_page 页面\n    @property({type:Node})\n    home_page:Node = null;\n    //逻辑层\n    @property({type:LogicCtl})\n    logic_ctl:LogicCtl = null;\n    //本局得分\n    @property({type:Label})\n    score_label:Label = null;\n    \n\n    start() {\n        //设置homg page 显示在屏幕中间\n        this.home_page?.setPosition(0,0);\n        //注册监听自定义事件 (更新分数)\n        EventDispatcher.get_instance().target.on(EventDispatcher.UPDATE_SCORE_LABEL,this.update_score_label,this);\n        //注册监听自定义事件 (开始游戏)\n        EventDispatcher.get_instance().target.on(EventDispatcher.START_GAME,this.start_game,this);\n        //延迟2秒执行自动跳\n        this.schedule(this.auto_play,2,macro.REPEAT_FOREVER,2);\n    }\n\n    update(deltaTime: number) {\n    }\n\n    /**\n     * 更新本局得分\n     */\n    update_score_label(){\n        this.score_label.string = GameData.get_total_score()+\"\";\n    }\n\n    /**\n     * 手动开始游戏\n     */\n    start_game():void{\n        this.unschedule(this.auto_play);\n        //设置默认本局得分0\n        this.score_label.string = \"\"+0;\n        //重置游戏数据,游戏状态\n        GameData.reset_data();\n        //移动和隐藏,home page\n        this.home_page.setPosition(-1000,0);\n        this.home_page.active = false;\n        //开始游戏,状态为1\n        this.logic_ctl?.run_game(1);\n    }\n    /**\n     * 自动开始游戏\n     */\n    auto_play(){\n        // 状态合法性判断\n        if(GameData.get_game_state() == -1){\n            //自动跳\n            this.logic_ctl.auto_jump();\n        }\n    }\n\n}\n\n"]}