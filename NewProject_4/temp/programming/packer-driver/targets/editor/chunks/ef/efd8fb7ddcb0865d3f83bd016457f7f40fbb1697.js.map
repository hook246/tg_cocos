{"version":3,"sources":["file:///Users/feiwang/tg_cocos/NewProject_4/assets/resources/scripts/home/homeView.ts"],"names":["_decorator","Button","Component","Label","Node","tween","UIOpacity","inviteModel","profileModel","earnView","WebUtils","ccclass","property","homeView","pageArray","btns","currentPageIndex","prePageIndex","start","window","Telegram","WebApp","setHeaderColor","error","discoverPage","invitePage","earnPage","drawPage","discoverPageBtn","invitePageBtn","earnPageBtn","drawPageBtn","jumpToCommunity","openTelegramLink","tryInstantView","shiftCurrentPage","btn","data","forEach","page","index","getPosition","x","Number","getComponent","to","opacity","call","setPosition","inviteBg","active","public_elements","console","log","node","getChildByName","currentTarget","getTaskList","freshTasks","setProfile","url","getResouceImg","icon","showProfile","profile","initData","update","deltaTime","public_text"],"mappings":"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","sourcesContent":["import { _decorator, Animation, AnimationClip, Button, Component, EventTouch, Label, Node, tween, UIOpacity } from 'cc';\nimport { inviteView } from '../invite/inviteView';\nimport { inviteModel } from '../invite/inviteModel';\nimport { profileModel } from '../profile/profileModel';\nimport { earnView } from '../earn/earnView';\nimport WebUtils from '../common/WebUtils';\nimport { PromiseUtils } from '../common/PromiseUtils';\nconst { ccclass, property } = _decorator;\n\n@ccclass('homeView')\nexport class homeView extends Component {\n\n    @property(Node)\n    discoverPage: Node = null\n    @property(Node)\n    invitePage: Node = null\n    @property(Node)\n    earnPage: Node = null\n    @property(Node)\n    drawPage: Node = null\n\n    @property(Node)\n    discoverPageBtn: Node = null\n    @property(Node)\n    invitePageBtn: Node = null\n    @property(Node)\n    earnPageBtn: Node = null\n    @property(Node)\n    drawPageBtn: Node = null\n    @property(Node)\n    profile: Node = null\n\n    @property(Label)\n    game_point: Label = null\n\n    @property(Node)\n    inviteBg: Node = null\n\n    @property(Node)\n    icon: Node = null\n\n    @property(Node)\n    public_text: Node = null\n\n    @property(Button)\n    go: Button = null\n\n    @property(Node)\n    public_elements: Node = null\n\n    pageArray: Node[] = [\n\n    ]\n\n    btns: Node[] = [\n\n    ]\n\n    currentPageIndex = 0\n    prePageIndex = 0\n    \n    start() {\n        try {\n            window?.Telegram?.WebApp.setHeaderColor('#000000')\n        } catch (error) {\n            \n        }\n\n        this.pageArray = [\n            this.discoverPage,\n            this.invitePage,\n            this.earnPage,\n            this.drawPage\n        ]\n\n        this.btns = [\n            this.discoverPageBtn,\n            this.invitePageBtn,\n            this.earnPageBtn,\n            this.drawPageBtn\n        ]\n    }\n\n    jumpToCommunity(){\n        window.Telegram.WebApp.openTelegramLink(`https://t.me/InfinityGroundAnn`, { tryInstantView: true });\n    }\n\n    async shiftCurrentPage(btn: EventTouch, data: string){\n        this.pageArray.forEach(async (page: Node, index)=>{\n            if((this.pageArray[index] as Node).getPosition().x === 0){\n                if(Number(data) === index){\n                    return\n                }\n                tween(this.pageArray[index].getComponent(UIOpacity)).to(0.5, { opacity: 0 }).call(()=>{\n                    this.pageArray[index].setPosition(-5000, 0);\n                    this.pageArray[index].getComponent(UIOpacity).opacity = 255;\n                    (this.pageArray[Number(data)] as Node).setPosition(0,0);\n                }).start();\n            }\n        });\n\n        //(this.pageArray[this.prePageIndex] as Node)?.getComponent(Animation)?.play();\n        \n        if(Number(data) === 1){\n            this.inviteBg.active = true\n            this.public_elements.active = false\n        }else{\n            this.inviteBg.active = false\n            this.public_elements.active = true\n        }\n        console.log('======', btn)\n        this.btns.forEach((node)=>{\n            node.getChildByName('selectBg').active = false\n            node.getChildByName('selected').active = false\n        })\n        btn.currentTarget.getChildByName('selected').active = true\n        if(Number(data) === 2){\n            await this.invitePage.getComponent(inviteModel).getTaskList()\n            this.earnPage.getComponent(earnView).freshTasks()\n        }\n\n        if(Number(data) === 0){\n            this.public_elements.active = false\n        }else{\n            this.public_elements.active = true\n        }\n    }\n\n    setProfile(url: string){\n        WebUtils.getResouceImg(url, this.icon)\n    }\n\n    async showProfile(){\n        await this.invitePage.getComponent(inviteModel).getTaskList()\n        this.profile.getComponent(UIOpacity).opacity = 0;\n        tween(this.profile.getComponent(UIOpacity)).to(0.5, { opacity: 255 }).call(()=>{\n            this.profile.getComponent(profileModel).initData()\n            this.profile.setPosition(0, 0)\n        }).start();\n    }\n\n    update(deltaTime: number) {\n        //-600\n        if(this.public_text.getPosition().x > -600){\n            this.public_text.setPosition(this.public_text.getPosition().x - deltaTime * 50, 0)\n        }else{\n            this.public_text.setPosition(600, 0)\n        }\n\n    }\n}\n\n"]}